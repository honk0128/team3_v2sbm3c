<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dev.mvc.breply.BreplyDAOInter">

  <!-- 댓글 입력 -->
  <insert id="replycreate" parameterType="dev.mvc.breply.BreplyVO">
    INSERT INTO breply(BREPLYNO, BREPLYCONT, BREPLYIMG, BREPLYSAVED, BREPLYTHUMB, BREPLYSIZE, BREPLYDATE, BREPLYPASSWD)
    VALUES(breply_seq.nextval, #{breplycont}, #{breplyimg}, #{breplysaved}, #{breplythumb}, #{breplysize}, sysdate, #{breplypasswd})
  </insert>

  <!-- 댓글 목록 -->
  <select id="reply_list" resultType="dev.mvc.breply.BreplyVO">
    SELECT BREPLYNO, BREPLYCONT, BREPLYIMG, BREPLYSAVED, BREPLYTHUMB, BREPLYSIZE, BREPLYDATE, BREPLYPASSWD
    FROM breply
    ORDER BY BREPLYNO ASC
  </select>

  <select id="read" resultType="dev.mvc.breply.BreplyVO" parameterType="int">
    SELECT BREPLYNO, BREPLYCONT, BREPLYIMG, BREPLYSAVED, BREPLYTHUMB, BREPLYSIZE, BREPLYDATE, BREPLYPASSWD
    FROM breply
    WHERE breplyno = #{breplyno}
  </select>

  <!-- 댓글(글) 수정 -->
  <update id="update_contents" parameterType="dev.mvc.breply.BreplyVO">
    UPDATE BREPLY
    SET BREPLYCONT = #{breplycont}, BREPLYDATE = sysdate, BREPLYPASSWD = #{breplypasswd}
    WHERE BREPLYNO = #{breplyno}
  </update>

  <!-- 댓글(사진) 수정 -->
  <update id="update_img" parameterType="dev.mvc.breply.BreplyVO">
    UPDATE BREPLY
    SET BREPLYIMG = #{breplyimg}, BREPLYSAVED = #{breplysaved}, BREPLYthumb = #{breplythumb}, BREPLYSIZE = #{breplysize}
    WHERE BREPLYNO = #{breplyno}
  </update>

  <delete id="delete" parameterType="int">
    delete BREPLY
    WHERE BREPLYNO = #{breplyno}
  </delete>

  <select id="password_check" resultType="int" parameterType="HashMap">
    SELECT COUNT(*) as cnt 
    FROM contents
    WHERE replyno = #{replyno} AND breplypasswd=#{breplypasswd}
  </select>

</mapper>